%% 和文論文用のテンプレート
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% 1. 和文原稿
% \documentclass[originalpaper]{jsaiart}     % 原著論文 Original Paper
% \documentclass[blindreview]{jsaiart}      % 査読用
%
% \documentclass[shortpaper]{jsaiart}       % 速報論文 Short Paper
% \documentclass[exploratorypaper]{jsaiart} % 萌芽論文 Exploratory Research Paper
\documentclass[Specialissue]{jsaiart}     % 特集 Special Issue
% \documentclass[specialissue]{jsaiart}     % 小特集 Special Issue
% \documentclass[interimreport]{jsaiart}    % 報告 An Interim Report
% \documentclass[surveypaper]{jsaiart}      % 解説 Survey Paper
% \documentclass[aimap]{jsaiart}            % AIマップ AI map
% \documentclass[specialpaper]{jsaiart}     % 特集論文 Special Paper
% \documentclass[invitedpaper]{jsaiart}     % 招待論文 Invited Paper
%

%% ページ番号の指定，掲載時に学会の方で決定します．
% \setcounter{page}{1}
% \setcounter{volpage}{1}


%%% amsmathパッケージの注意点 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \usepackpage{amsmath}
% 数式番号の参照は \ref ではなく，\eqref を用いること
% documentclass のオプションに fleqnを指定すること
% 例: \documentclass[technicalpaper,fleqn]{jsaiart}
\usepackage[dvipdfmx]{graphicx}

\Vol{12}
\No{1}
\jtitle{三角化曲面に付随する団代数に対応する置換変異について}
% \jtitle[柱用和文タイトル]{和文タイトル}
\jsubtitle{和文サブタイトル}
\etitle{Mutations of permutations corresponding to cluster algebra in triangulated surfaces}
\esubtitle{英文サブタイトル}

\manyauthor % 著者が3名以下の場合はこの行を消すこと

%%% 著者名の注意点 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 所属先が同じ著者が連続する場合，その中の先頭の著者のみ \affiliation
% を用い，残りの所属先には \sameaffiliation を使う
% ただし，所属先が同じでも連続していない場合は \affliation を使う
% 名前が長い場合は \name の代りに \longname を使う

\author{%
 \name{山田}{亮}{Yamada, Ryo}
 \affiliation{京都大学大学院医学研究科統計遺伝学分野}%
    {Unit of Statistical Genetics, Graduate School of Medicine, Kyoto University}%
    {yamada.ryo.5u@kyoto-u.ac.jp, https://www.med.kyoto-u.ac.jp/organization-staff/research/doctoral_course/r-028/}
\and
 \name{木下}{瞬}{Kinoshita, Shun}
 \sameaffiliation{skinoshi@me.com,https://www.med.kyoto-u.ac.jp/organization-staff/research/doctoral_course/r-028/}
\and
 \name{和田}{みのり}{Wada, Minori}
 \sameaffiliation{mnr.wa2417@gmail.com,https://www.med.kyoto-u.ac.jp/organization-staff/research/doctoral_course/r-028/}
\and
 \name{三村}{和史}{Mimura, Kazushi}
 \affiliation{広島市立大学大学院情報科学研究科知能工学専攻}%
    {Affiliation2 in English}%
    {mimura@hiroshima-cu.ac.jp, http://www.info.hiroshima-cu.ac.jp/~mimura/index_j.html}
\and
 \name{杉山}{磨人}{Sugiyama, Mahito}
 \affiliation{国立情報学研究所情報学プリンシプル研究系}%
    {Affiliation2 in English}%
    {mahito@nii.ac.jp, https://www.nii.ac.jp/faculty/informatics/sugiyama_mahito/}
}

\begin{keyword}
permutation, cluster algebra, triangulation
\end{keyword}

% \begin{summary}
% 「ショートノート」は 200 ワード，それ以外は200〜500 ワード
% 以内の英文でsummaryを記す
% \end{summary}





\begin{document}
\maketitle

\section{はじめに}
団代数とは、 Fomin と Zelevinsky が 2000 年頃に導入した
ある種の可換代数のクラスであり\cite{FZ2002}、数学の諸分野に偏在的に現れる一つの基礎的な代数的・組み合わせ論的構造のことである、と説明される\cite{Nakanishi2015}。
その応用範囲は広いが、本稿では、データ科学における変数選択・変数分類・変数順序を念頭に置き、既知の３つの団代数の例を紹介する。
まず初めに、変数集合の族に対応する団代数構造とみなせる
団代数の例として、正方行列の小行列に関するそれを紹介し、ついで、変数ペアに伴う団代数が凸多角形の三角形分割に対応する例を示し、三角化曲面の団代数について述べる。
その上で、第３の例である三角化曲面が複数の置換によって表現できることを介して、三角化曲面の団代数構造に対応する置換の変異が定義できることを示す。
組合せと置換はデータ科学において基本的なツールであり、それらを団代数と結びつけることで、数学の諸分野との連携を深める端緒を紹介することを本稿の目的とする。

\section{団代数とは}

\subsection{箙(えびら)という有向グラフ}
頂点数$n$の有向グラフ$Q$を定める。$Q$はループを持たず、任意の２頂点間には、0,1,または複数本の有向辺を与えうるが、すべての辺の向きは同じであるという制約を付ける。
このような制約のあるグラフを箙(Quiver)と言う。

$Q$に「変異」という操作を以下のように定める。
\begin{itemize}
    \item $n$個の頂点の１つを取り出し、$v_i$とする
    \item $v_i$に接続する辺の向きを逆にする
    \item 有向辺 $v_j \to v_i$が$n_{in}$本あり、$v_i \to v_k$が$n_{out}$本あるとき、有向辺$v_j \to v_k$を$n_{in} \times n_{out}$本、加える
    \item $v_j \leftrightarrow v_k$間に向きの異なる辺が生じた場合には、順逆の辺の本数の差にあたる本数のみを残す。順逆の本数に差がないときは、無辺とする
\end{itemize}

図1に具体例を示した。
 
 この操作によって得られるグラフは、$n$個の頂点のどれを選んでも箙となることが知られており、$n$個の頂点を持つ箙には、$n$通りの変異が存在することになる。
 
 箙を頂点とし、変異によって移り変わりあう箙同士を辺で結ぶと、$n$-正則グラフになる。
 
 \begin{figure}[t]
 \centering
 \includegraphics[keepaspectratio,width=8cm]
      {quiver.jpg}
 \caption{(1)4頂点箙がある。頂点2(赤色頂点)について変異することとする。(B1)頂点2に接続する3辺の向きを反転した(水色辺)。(B2)(辺1->2, 辺2->3)の関係から、辺1->3を追加した(赤色辺)。(辺4->2, 辺2->3)の関係から、辺4->3を追加した(赤色辺)。(C)頂点3,4間の辺は相互に逆向きなので打ち消し合って、無辺となった。}
 \label{ラベル名}
\end{figure}
 
 
 
\subsection{団代数}

$Q$の隣接行列を$A_Q$とするとき
$$
B_Q = A_Q - A_Q^T
$$
なる正方行列を定義する。
定義から「歪対称行列」であることがわかる。

図1(A),(C)の箙の歪対称行列は、それぞれ、
$$
 B_A = \left(
    \begin{array}{cccc}
      0 & 1 & 0 & 0 \\
      -1 & 0 & 1 & -1 \\
      0 & -1 & 0 & 1 \\
      0 & -1 & 1 & 0
    \end{array}
  \right)
$$
$$
 B_C = \left(
    \begin{array}{cccc}
      0 & -1 & 1 & 0 \\
      1 & 0 & -1 & 1 \\
      -1 & 1 & 0 & 0 \\
      0 & -1 & 0 & 0
    \end{array}
  \right)
$$

$Q$をある頂点に関して変異させ、$Q’$が得られたとする。

$Q'$にも歪対称行列$B_{Q'}$が定まるが、

$B_{Q'}$は、$B_Q$の要素を用いて算出することができる。

他方、$n$個の頂点に２種類の変数の組$X=\{x_1,...,x_n\}$,$Y=\{y_1,...,y_n\}$を定める。

箙の変異に伴い$X,Y$も変化していくが、$Y_{Q}$から$Y_{Q'}$への変化は、$Y_Q$の要素と$B_Q$の要素で定まり、$X_{Q}$から$X_{Q'}$への変化は、$B_Q$,$X_Q$,$Y_Q$から算出できる。

結局、$(B,X,Y)$なる、行列と２種類の変数とからなる三つ組があり、変異という操作により、$(B',X',Y')$に変化するルールがあるという話である。

この個々の三つ組をシードと呼び、シードは変異によって変化するが、変化にあたっては、$n$個の要素が「団(体)のメンバー」として振舞い、そこに代数構造が認められるので、「団代数」と称される。
また、箙の変異の説明からわかるように、$n$個のメンバーのうち、1メンバーとその他の$n-1$個のメンバーとの関係のみが変わるという特徴もあり、
変異で隣り合わせのシード同士は一部を除いて共通する点が多いという性質もある。

団代数の代数的特徴は有用で興味深いが、本稿ではそれには触れないが、
簡潔な概説を参考文献として挙げておく\cite{Nakanishi2015-2} 。

\section{組み合わせと小行列式と団代数}

変数集合 $\mathbf{X} = \{X_1,X_2,...,X_n\}$を考える。
簡単のために$\{1,2,...,n\}$と書くことにする。

集合の族 $\mathcal{S} = \{\phi,\{1\},\{2\},...,\{n\},\{1,2\},...,\{1,2,...,n-1\},...,\{2,...,n\},\{1,2,...,n\}\}$
は$2^n$の要素からなり、$n$次元超立方体の形をした包含関係にある。

\subsection{組合せに対応する団代数〜フラッグ小行列式の団代数〜}

図2を例に、組合せの一部を表示する方法とその変異を確認する。
$n=5$本の紐を用意する。紐には1,2,...,nの番号が振ってあり、左側では下から上に昇順、右側では下から上に降順になっている。
すべての紐のペアは必ず1回だけ交叉するという決まりとする。

図2(A)を見ると、左右両端に$n-1$個ずつ、計$2(n-1)$個の端が閉じていない部屋がある。
両端が閉じた部屋は下の層から$(n-2), (n-1),...,1$個の部屋があるから、計$\frac{(n-1)(n-2)}{2}$個の部屋ができる。

各部屋には部分集合を割り当てる。割り当てる部分集合は、その部屋より
下を通過している紐の番号で決めるというルールにする。

図2(B)では、第2の紐を少し動かしてある。両端の部屋は不変である。
内側の部屋の数は変わらないが、現れる部分集合が(A)とは異なっている。

(A)にはあった(2)がなくなり、その代わりに(1,3)が出現した。

$((2),(3),(4),(2,3),(3,4),(2,3,4))$
から
$((3),(4),(1,3),(2,3),(3,4),(2,3,4))$
へと変化した。
内部の部屋の部分集合の団の１メンバーだけ変更になって、他のメンバーに変化はなかった。
これは、箙を用いて説明した団代数と同じ仕組みになっている。
 \begin{figure*}[t]
 \centering
 \includegraphics[keepaspectratio,width=16cm]
      {fig2_ver2.jpg}
 \caption{紐ダイアグラムによる組合せの配置。5本の紐は左側では下から昇順に、右側では上から昇順になっている。すべての紐ペアは必ず1回交叉している。(A)の状態から2番の紐を動かすことで(B)の状態に変異させたとみなすと、(A)のダイアグラムには存在した(2)がなくなり、代わりに(B)に(1,3)が現れている。}
 \label{ラベル名}
\end{figure*}
実際、この紐ダイアグラムの内側の部屋を頂点とした箙を構成することもできて、(A)から(B)への変化は箙変異と対応付けることができる。
そして、紐の移動〜対応する箙の変異により、空集合以外のすべての部分集合が部屋として現れることも知られている。

言い換えると、要素数$n$の集合が与えられたとき、$2(n-1)$個の両端相当の部分集合を固定し、残りの$(2^n-1) - 2(n-1)$個の部分集合のうち、$\frac{(n-2)(n-1)}{2}$個の部分集合を団とすると、$\frac{(n-2)(n-1)}{2}$個のメンバーのうち1メンバーずつを取り換えることで、$(2^n-1) - 2(n-1)$個のすべてを登場させるような$n$正則グラフ構造が存在するということになる。

しかも、この変異に伴い次の小行列式の等式が成立する。

$$
\Delta_{(2),(1)}\times \Delta_{(1,3),(1,2)} = \Delta_{(1),(1)} \times \Delta_{(2,3),(1,2)} + \Delta_{(3),(1)} \times \Delta_{(1,2),(1,2)}
$$
ただし、$\Delta_{(I),(J)}; \; I = (i_1,...i_k), J= (j_1,...,j_k)$は
$n\times n$行列の$I$行と$J$列を抜き出した、$k \times k$行列の行列式である。

ここで$J=(1,2,3,...,k)$のように列の選び方が小さい値に片寄せていることに注意する。
このような小行列式をフラッグ小行列式と呼ぶので、集合の族〜組み合わせパターン〜はフラッグ小行列式が満足する演算ルールと結びついた団代数構造と関係すると言い表せる。詳細は参考文献\cite{fomin2020introduction}を参照されたい。

\subsection{"組合せ$\times$組合せ"に対応する団代数〜小行列式全体の団代数〜}

フラッグ小行列式は、行は要素の組合せの全体を網羅していたが、列は組み合わせではなく、番号の小さい側に片寄せていた。

行も列も自由な組合せにすると、$n\times n$行列のすべての小行列式が対象になる。

実際、図2の紐ダイアグラムを2組、用意することで、全ての小行列式の団代数が構成できる。

図3がその例である。

3本の黒紐の番号も、赤紐のそれも左右で昇順・降順が逆になっている。
色別の紐はそれぞれ1回ずつ交叉しており、二色の紐の交叉によって仕切られる部屋には、黒・赤それぞれの紐番号に対応して部分集合が割り当てられている。
黒・赤に対応する部分集合のサイズは同じであり、それぞれを行番号・列番号とした小行列式が対応付けられる。
$n \times n$行列の小行列式の総数は
$\sum_{i=1}^n \begin{pmatrix}n\\i \end{pmatrix}$ 通りあるが、ダイアグラムには、両端の部屋も含めて$n^2$の部屋のみが登場する。

詳細は他に譲るが、紐ダイアグラムには箙を対応付けることができ、団代数が付随する。団代数の変異により、構成小行列式のが変わり、すべての小行列式が登場し得る。
この団代数の変異に伴って小行列式間に成立する関係式が存在するが、その関係式の性質を利用すると、二色紐ダイアグラムに登場する$n^2$個の小行列の正値性を確認するだけで、すべての小行列式が正であることの確認が取れることが知られている\cite{fomin2020introduction}。




 \begin{figure}[h]
 \centering
 \includegraphics[keepaspectratio,width=8cm]
      {fig3_ver2.jpg}
 \caption{2つの紐ダイアグラムの組合せ。黒紐3本は、左側で下から昇順に、赤紐3本は右側で下から昇順になっている。黒紐ダイアグラムと赤紐ダイアグラムを合わせると、黒・赤それぞれに同サイズの部分集合が定義されている様子が、各部屋に()内の数値で示されている。黒の数値を行番号、赤の数値を列番号とする小行列式が各部屋に対応づいていると読む。}
 \label{ラベル名}
\end{figure}


\subsection{２要素組み合わせの団代数〜グラスマン多様体$Gr(k=2,n)$と凸多角形の三角化}

グラスマン多様体 $Gr(k,n)$は、$n$次元空間上の$k$次元線形部分空間の集合のことである\cite{Grass}。

集合の族との関係で言えば、要素数$n$の集合の部分集合の族のうち、サイズが$k$の部分集合に限定した場合との見方もできる。

$Gr(k,n)$の部分集合には、グラスマン座標を付与することができる\cite{GrassCoords}が、このグラスマン座標は、$k \times n$行列から取り出せる$k \times k$ 部分行列の行列式から構成される。

集合の族と関係した団代数では、上述の通り、小行列式間の関係式が登場したが、集合の族のうち次元をそろえた部分集合に相当するグラスマン多様体の座標が、同じく部分行列の行列式であることには関係がある。

ここでは、$k=2$の場合を考える。

凸$n$角形の頂点に1,2,...,nと番号を付与する。
このとき、$n$個から2個を取り出す組合せは$\begin{pmatrix}n \\ 2 \end{pmatrix}$ となるが、それを多角形との関係で幾何的に表現すると、多角形の外周の辺(n本)もしくは、対角線のいずれかに相当する。

図4に示すように、$n$角形には$n-3$本の対角線が引けるが、ある対角線を１本取り除き、別の対角線を引き直すことができる。

部分的に見ると、ある対角線に着目したときにその両側の2つの三角形が作る四角形に関して、2本引ける対角線の取り直し作業になっている。

 \begin{figure}[h]
 \centering
 \includegraphics[keepaspectratio,width=8cm]
      {fig4_ver2.jpg}
 \caption{。}
 \label{ラベル名}
\end{figure}



特に$k=2$の場合



■　また、n個の変数のペアについては、m-角形の対角線による三角化パターンという団代数が付随している。グラスマニアン(2,n)
すくなくとも多変数のペア組み合わせの探索空間も団代数的に扱える。

\begin{figure}[t]
 \centering
 \includegraphics[keepaspectratio,width=8cm]
      {Fig5.png}
 \caption{図の説明}
 \label{ラベル名}
\end{figure}




Ptolemyの定理








既知のこととして、次のようなことが知られている。

■　正方行列の小行列集合が団代数になっている。
そのおかげで、{1,2,...,n}の集合の族{{1},{2},....,{1,2,...,n}} (2^n-1　個)の間に団代数構造がある。
それは、小行列の中でも、Flag minorと呼ばれる特別な小行列式に関する関係式で作り上げられる。
 ※ Flag minorはM[(1,3,7,8),(1,2,3,4)]のように、行は1...nの組み合わせ、列は、1始まりの整数列。
Flag minorをうまく使うと、y ~ X 型の多変量解析における変量のすべての組み合わせの探索空間として使えるかもしれない。

小行列式全体をうまく使うと、多変量 ~ 多変量　(Y ~ X 型)　データ解析での、変量組み合わせ総当たりの探索空間として使えるかもしれない。


\section{三角化曲面と団代数}
団代数が認められる構造には、三角メッシュがある。
三角メッシュは、|V| = k + 2, |E| = 3k, |F| = 2k なるグラフだが、それの箙表現は二つのdisjoint cycles からなる置換行列の和になっている(1つ目の置換行列は、|F|個の長さ３の有向サイクルの集まり。もう一つの置換行列は、|V|個の長さ＝頂点次数の有向サイクルの集まり)。

これを箙〜有向グラフとしてみなすと、ここで終わりだが、これを無向グラフ化すると、長さ３の無向サイクルの集まり　と　頂点次数無向サイクルの集まり　との和とみなせる。

この２つの置換の正逆2倍の和は、三角メッシュに認められる「擬直線(ジグザグ進んでできるサイクル)」というdisjoint cycles〜置換の正逆2倍〜に分けられることが知られている。

したがって、三角メッシュ箙が構成する、三角メッシュの団代数シード変異には、「擬直線〜置換」同士の変異則のようなものが付随している。これを利用すると:

既知の団代数では「組み合わせ」が団代数構造化されていたのに対して
「順列(の全体か一部かは未解決)」も団代数構造化できて、それを探索空間化できるのではないか。

順列は組み合わせよりも、多変量データサイエンスの観点からは用途が狭い印象があるが、例えば、「寄与の強い順序つきで、意味のある変数の組を見つけ出したい」というような要請があるときには、使える構造の可能性がある。

なお、順列が作る相互関係にはBirkhoff polytopeが知られている(三村先生から先日いただいたインプット)が、三角メッシュを通じて得られる順列間の相互関係は、Birkhoff polytopeの部分集合のようになっている可能性もあり、さらなる発展として、順列全体をカバーする団代数の構成や、その幾何的・箙的表現の発見の端緒となる可能性がある。
\section{三角化曲面と置換}

\section{三角化曲面の団変異による置換の変異}




 





---ここまでが既知






---ここからアイディア。




\section{まとめ}

\begin{acknowledgment}
三角化曲面の団代数・小行列式の団代数に関して、幅広いディスカッションをしてくださった、東京工業大学情報理工学院　鈴木咲衣准教授に感謝いたします。

\end{acknowledgment}

\bibliography{btxsample}
\bibliographystyle{jsai}

\appendix

\section{付録のタイトル1}

付録の本文1

\section{付録のタイトル2}

付録の本文2

% 著者の姓と名の間は半角スペースで区切る
% 略歴は200字以内
\begin{biography}
\profile{非会員}{山田 亮}{京都大学大学院医学研究科疾患ゲノム疫学分野准教授(2005年4月-2007年3月)、東京大学医科学研究所ヒトゲノム解析センターゲノム機能解析分野准教授(2007年4月-2009年7月)、京都大学大学院医学研究科統計遺伝学分野教授(2009年8月-)、京都大学数理解析研究所特任教授(2015年4月-)、久留米大学バイオ統計センター客員教授(2021年4月-)}
\profile*{非会員}{木下 瞬}{京都大学医学部医学科(2019年4月-)}
\profile*{非会員}{和田 みのり}{京都大学医学部医学科(2018年4月-)}
\profile*{非会員}{三村 和史}{}
\profile*{m}{杉山 磨人}{}
\end{biography}

\end{document}
