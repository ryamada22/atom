---
title: "確率変数について"
author: "ryamada"
date: "2020/7/19"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 確率変数

確率変数Xは、問いかけられると、何かを返す機械のようなもの。

その機械は、返す可能性のある事象の集合Sと事象を$R_+$値に対応づける写像$p_X: S \to R_+$とを持ち、

特に
$$
\int_S p_X(s) ds= 1
$$


を満足する。

## モーメント

確率変数には、モーメントと言う概念があり、自然数 k に対して、k次モーメント$M_k(X)$が以下のように定義される。

$$
M_k(X) = \int_S s^k p_X(s) ds
$$

## $\sigma$-加法族

上記の定義からわかるように、集合Sは、$\sigma$-加法族となっている。

## 問題設定

本小文では、次のような問題設定を考える。

確率密度、モーメントは、確率変数から独立に発生する単一事象に関する情報である。

今、確率変数から、独立に発生する値のペアに関する情報を取った時、どんな情報が取れるのかについて考えてみたい。

## 同時分布

１つの確率変数から独立に発生させた事象値のペアを、２次元同時分布として捉えた時、
その周辺確率密度分布は、当該確率変数の確率密度に過ぎない。

したがって、この２次元同時分布は、冗長ではあるが、なんら、情報を増やしているものではない。

しかし、２変数の和の分布や差の分布をとること自体は可能である。

そして、和の分布は、確率密度分布を台の方向に２倍したものに過ぎない。

他方、差の分布は、期待値を中心とした差の分布と何らかの関係があるように思われる。

## 相互に独立な２つの確率変数が作る同時分布から得られるスカラー量の期待値

相互に独立な２確率変数から多項式によって得られる値について考える。

この値は、ある確率変数からの独立な値とみなせるが、そのモーメントは、元の２つの確率変数のモーメントから計算できる。

```{r}
n <- 100000
rx1 <- rnorm(n,0,1)
rx2 <- rnorm(n,2,2) + runif(n)

rx12 <- cbind(rx1,rx2)
plot(rx12)
```

```{r}
par(mfcol=c(2,2))
hist(rx1)
hist(rx2)
hist(rx1 + rx2) 
hist(rx1 - rx2) 
par(mfcol=c(1,1))
```

```{r}
M2X1 <- mean(rx1^2)
M2X2 <- mean(rx2^2)
M1X1 <- mean(rx1^1) 
M1X2 <- mean(rx2^1) 

M2X1 + M2X2 - 2 * M1X1 * M1X2

mean((rx1-rx2)^2)
```

```{r}
M1X1 <- mean(rx1)
M1X2 <- mean(rx2) 
M2X1 <- mean(rx1^2) 
M2X2 <- mean(rx2^2) 
M3X1 <- mean(rx1^3) 
M3X2 <- mean(rx2^3) 

M3X1 -3 * M2X1 * M1X2 + 3 * M1X1 * M2X2 - M3X2

mean((rx1-rx2)^3)
```

## 相互に独立でない２つの確率変数の場合

この場合は、２つの確率変数からある式で得られるスカラー確率変数のモーメントは、元の２つの確率変数のモーメントから計算することはできない

```{r}
n <- 100000
rx1 <- rnorm(n,0,1)
rx2 <- rnorm(n,2,2) + runif(n) * rx1 # rx1 と rx2 とに関連を入れる

rx12 <- cbind(rx1,rx2)
# plot(rx12)
```

```{r}
M1X1 <- mean(rx1)
M1X2 <- mean(rx2) 
M2X1 <- mean(rx1^2) 
M2X2 <- mean(rx2^2) 
M3X1 <- mean(rx1^3) 
M3X2 <- mean(rx2^3) 

M3X1 -3 * M2X1 * M1X2 + 3 * M1X1 * M2X2 - M3X2

mean((rx1-rx2)^3)
```
