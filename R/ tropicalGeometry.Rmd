---
title: "Tropical geometry"
author: "ryamada"
date: "2020/9/10"
output: html_document
---
```{r setup}
library(knitr)
library(rgl)
knit_hooks$set(rgl = hook_rgl)
```
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Tropical arithmetic

```{r}
my.trop.sum <- function(x,y){
  max(x,y)
}
my.trop.prod <- function(x,y){
  x+y
}
```

```{r}
x <- y <- seq(from=-3,to=3,length=11)
xy <- expand.grid(x,y)
regular.sum <- xy[,1]+xy[,2]
regular.prod <- xy[,1]*xy[,2]
trop.sum <- apply(xy,1,max)
trop.prod <- apply(xy,1,sum)
```

```{r, rgl=TRUE}
plot3d(xy[,1],xy[,2],regular.sum) 
plot3d(xy[,1],xy[,2],regular.prod) 
plot3d(xy[,1],xy[,2],trop.sum)
plot3d(xy[,1],xy[,2],trop.prod)
```

## 脱量子化

```{r}
my.hsum <- function(x,y,h){
  h * log(exp(x/h) + exp(y/h)) 
}
x <- 3
y <- 2
hs <- seq(from=0,to=3,length=1001)
hs <- hs[-1]
v <- rep(0,length(hs))
for(i in 1:length(v)){
  v[i] <- my.hsum(x,y,hs[i])
}
plot(hs,v)

```